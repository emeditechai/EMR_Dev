@model EMR.Web.Models.ViewModels.RoleSelectionViewModel
@{
    Layout = "_AuthLayout";
    ViewData["Title"] = "Select Role";
}

<div class="auth-card">
    <div class="row g-0">
        <div class="col-lg-5 auth-left d-none d-lg-flex flex-column justify-content-center">
            <h1 class="display-5 fw-bold mb-4">Hello, @Model.DisplayName!</h1>
            <p class="fs-5 mb-3">You have multiple roles assigned for <strong>@Model.BranchName</strong>.</p>
            <p class="fs-5 mb-4">Select the role you want to work with for this session.</p>
            <ul class="list-unstyled fs-5">
                <li class="mb-2">● Branch-specific role access</li>
                <li class="mb-2">● Role-based data visibility</li>
                <li class="mb-2">● Switch roles anytime from profile</li>
            </ul>
        </div>
        <div class="col-12 col-lg-7 auth-right d-flex flex-column">
            <h2 class="brand-title mb-1">eMedi<span>EMR</span></h2>
            <h3 class="h2 mb-1">Select Your Role</h3>
            <p class="text-muted mb-4">
                <i class="bi bi-building me-1"></i>@Model.BranchName
            </p>

            <form asp-action="SelectRole" method="post" novalidate id="roleForm">
                @Html.AntiForgeryToken()
                <input type="hidden" name="rememberMe" value="@Model.RememberMe.ToString().ToLower()" />
                <input type="hidden" name="selectedRole" id="selectedRoleInput" />

                <div class="role-card-grid mb-4">
                    @foreach (var role in Model.Roles)
                    {
                        <button type="button" class="role-card" onclick="selectRole('@role.Name', this)">
                            <i class="bi @role.Icon role-card-icon"></i>
                            <span class="role-card-name">@role.Name</span>
                            <i class="bi bi-check-circle-fill role-card-check"></i>
                        </button>
                    }
                </div>

                <button type="submit" id="continueBtn" class="btn btn-lg w-100 text-white" style="background: var(--emr-gradient)" disabled>
                    <i class="bi bi-arrow-right-circle me-2"></i>Continue to Dashboard
                </button>
            </form>

            <form asp-controller="Account" asp-action="Logout" method="post" class="mt-3 text-center">
                @Html.AntiForgeryToken()
                <button class="btn btn-link text-decoration-none text-muted" type="submit">
                    <i class="bi bi-box-arrow-left me-1"></i>Back to Login
                </button>
            </form>
        </div>
    </div>
</div>

<style>
.role-card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 0.9rem;
}

.role-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.55rem;
    padding: 1.3rem 0.75rem 1rem;
    border: 2px solid #e3e8f3;
    border-radius: 14px;
    background: #f8faff;
    cursor: pointer;
    transition: border-color 0.18s, background 0.18s, box-shadow 0.18s, transform 0.15s;
    position: relative;
    text-align: center;
    color: #2d3a4e;
    font-size: 0.9rem;
}

.role-card:hover {
    border-color: #6b8cdb;
    background: #eef3ff;
    box-shadow: 0 4px 16px rgba(31, 59, 145, 0.10);
    transform: translateY(-2px);
}

.role-card.selected {
    border-color: var(--emr-primary, #1f3b91);
    background: linear-gradient(135deg, #e8eeff 0%, #d6e0ff 100%);
    box-shadow: 0 6px 20px rgba(31, 59, 145, 0.18);
    transform: translateY(-2px);
}

.role-card-icon {
    font-size: 2rem;
    color: var(--emr-primary, #1f3b91);
    opacity: 0.85;
}

.role-card.selected .role-card-icon {
    opacity: 1;
}

.role-card-name {
    font-weight: 700;
    line-height: 1.2;
}

.role-card-check {
    position: absolute;
    top: 0.5rem;
    right: 0.55rem;
    font-size: 1rem;
    color: var(--emr-primary, #1f3b91);
    opacity: 0;
    transition: opacity 0.18s;
}

.role-card.selected .role-card-check {
    opacity: 1;
}
</style>

<script>
function selectRole(name, el) {
    document.querySelectorAll('.role-card').forEach(c => c.classList.remove('selected'));
    el.classList.add('selected');
    document.getElementById('selectedRoleInput').value = name;
    document.getElementById('continueBtn').disabled = false;
}
</script>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
