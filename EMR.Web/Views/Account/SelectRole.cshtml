@model EMR.Web.Models.ViewModels.RoleSelectionViewModel
@{
    Layout = "_AuthLayout";
    ViewData["Title"] = "Select Role";
}

<div class="auth-card">
    <div class="row g-0 h-100">

        @* LEFT PANEL *@
        <div class="col-lg-6 auth-left d-none d-lg-flex">
            <div class="auth-icon-float" style="top:7%;left:8%"><i class="bi bi-heart-pulse-fill"></i></div>
            <div class="auth-icon-float" style="top:12%;right:10%"><i class="bi bi-capsule"></i></div>
            <div class="auth-icon-float" style="top:38%;left:5%"><i class="bi bi-bandaid-fill"></i></div>
            <div class="auth-icon-float" style="top:62%;right:8%"><i class="bi bi-thermometer-half"></i></div>
            <div class="auth-icon-float" style="bottom:14%;left:12%"><i class="bi bi-lungs-fill"></i></div>
            <div class="auth-icon-float" style="bottom:8%;right:14%"><i class="bi bi-activity"></i></div>

            <div class="auth-left-content">
                <div class="auth-medical-cross">
                    <i class="bi bi-person-badge"></i>
                </div>
                <h1 class="auth-left-title">Hello,<br /><span>@Model.DisplayName</span>!</h1>
                <p class="auth-left-sub">Role Selection</p>
                <hr class="auth-left-divider" />
                <ul class="auth-feature-list">
                    <li><i class="bi bi-check-circle-fill"></i> Branch: @Model.BranchName</li>
                    <li><i class="bi bi-check-circle-fill"></i> Role-based data visibility</li>
                    <li><i class="bi bi-check-circle-fill"></i> Switch roles anytime from profile</li>
                </ul>
            </div>
        </div>

        @* RIGHT PANEL *@
        <div class="col-12 col-lg-6 auth-right">
            <div class="auth-right-inner">

                <div class="auth-logo-badge d-flex d-lg-none">
                    <i class="bi bi-plus-lg"></i>
                </div>

                <div class="auth-welcome">
                    <h2 class="auth-right-title">Select Your Role <i class="bi bi-person-badge"></i></h2>
                    <p class="auth-right-sub"><i class="bi bi-building me-1"></i>@Model.BranchName</p>
                </div>

                <form asp-action="SelectRole" method="post" novalidate id="roleForm">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="rememberMe" value="@Model.RememberMe.ToString().ToLower()" />
                    <input type="hidden" name="selectedRole" id="selectedRoleInput" />

                    <div class="role-card-grid mb-4">
                        @foreach (var role in Model.Roles)
                        {
                            <button type="button" class="role-card" onclick="selectRole('@role.Name', this)">
                                <i class="bi @role.Icon role-card-icon"></i>
                                <span class="role-card-name">@role.Name</span>
                                <i class="bi bi-check-circle-fill role-card-check"></i>
                            </button>
                        }
                    </div>

                    <button type="submit" id="continueBtn" class="btn auth-signin-btn w-100" disabled>
                        <i class="bi bi-arrow-right-circle me-2"></i>Continue to Dashboard
                    </button>
                </form>

                <form asp-controller="Account" asp-action="Logout" method="post" class="mt-3 text-center">
                    @Html.AntiForgeryToken()
                    <button class="btn btn-link text-decoration-none auth-back-link" type="submit">
                        <i class="bi bi-box-arrow-left me-1"></i>Back to Login
                    </button>
                </form>

                <p class="auth-footer-note">
                    <i class="bi bi-shield-lock-fill me-1"></i>
                    Secured &amp; HIPAA-compliant access
                </p>
            </div>
        </div>

    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        function selectRole(name, el) {
            document.querySelectorAll('.role-card').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
            document.getElementById('selectedRoleInput').value = name;
            document.getElementById('continueBtn').disabled = false;
        }
    </script>
}
